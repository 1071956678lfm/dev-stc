swagger: '2.0'
info:
  description: 南大测试 REST API
  version: 1.0.0
  title: 南大测试 REST API 接口说明
  termsOfService: 'http://swagger.io/terms/'
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
host: 'localhost:8000'
tags:
  - name: login
    description: 登录
  - name: consign
    description: 委托
  - name: processInstance
    description: 流程实例状态
  - name: contract
    description: 合同
  - name: project
    description: 工程（当前完全是初始版本，传入参数以及返回数据内容孑需修改）
schemes:
  - http
consumes:
  - application/x-www-form-urlencoded
produces:
  - application/json
paths:
  /login:
    post:
      tags:
        - login
      summary: 登录
      description: 登录系统
      operationId: login
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名. 此时应默认为 **undefined**
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要. 此时应默认为 **undefined**
          type: string
          required: true
        - in: formData
          name: params
          description: |
            登录信息. JSON格式，需包含两个key， 'username' 以及 'password'.  eg.
            ```
            {
              "username": "admin",
              "password": "admin"
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            成功登录,data里包含User各种信息
              eg.
            ```
            {
              "data": {
                "password": "21232F297A57A5A743894A0E4A801FC3",
                "code": "2",
                "createdUserId": "2",
                "roles": [
                  {
                    "functionGroup": {
                      "Consign": [
                        "ADD",
                        "DELETE",
                        "EDIT",
                        "VIEW"
                      ]
                    },
                    "name": "normal_customer"
                  }
                ],
                "name": "Customer1",
                "id": "2",
                "credentialsSalt": "customer1null",
                "clientDigest": "dfcbbdfef1f8561cc04cf219736922c07af9be789ca53aa24af6594e89e81ccb",
                "username": "customer1"
              },
              "message": "",
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
  /services/consign:
    get:
      tags:
        - consign
      summary: 查询委托
      description: 用户为工作人员时，返回所有委托；用户为客户时，返回该客户的委托
      operationId: queryConsigns
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
      responses:
        '200':
          description: |
            成功查询委托时返回委托. data内包含JsonArray格式的委托内容
            查询失败时，返回一个失败的status
            ```
            {
              "status":failure;
            }
            ```
          schema:
            $ref: '#/definitions/Response'
        '405':
          description: Invalid input
    post:
      tags:
        - consign
      summary: 添加委托
      description: 向数据库中添加委托，成功时返回委托的具体信息以及一个success状态
      operationId: addConsign
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            委托内容具体内容. JSON格式
            ```
            {
              "consignation": "content"
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            成功添加委托时的样例response body
            ```
            {
              "data": {
                "processInstanceID": "24",
                "createdUserId": "0",
                "createdTime": "2018-05-19 20:34:22",
                "id": "fa5078a3-07cb-458f-b30f-26f0d710b445",
                "state": "State：提交委托 From: Consign:1:7",
                "consignation": "content"
                },
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    put:
      tags:
        - consign
      summary: 修改委托
      description: 修改已有的委托，参数中需要包含委托的id
      operationId: editConsign
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            委托具体内容. JSON格式. 需要指明ID
            ```
            {
              "id": 
              "consignation":
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            修改成功时的样例response body
            ```
            {
              "data": {
              "processInstanceID": "32",
              "createdUserId": "2",
              "alteredTime": "2018-05-19 20:54:42",
              "createdTime": "2018-05-19 20:48:24",
              "alteredUserId": "2",
              "id": "1708445d-a5c6-4425-b0b4-4bf96486941d",
              "state": "State：提交委托 From: Consign:1:7",
              "consignation": "excellent"
              },
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    delete:
      tags:
        - consign
      summary: 删除委托
      description: 删除一个委托，需要提供委托的具体id
      operationId: deleteConsign
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            委托具体内容. JSON格式. 需要指明ID,consignation为非必要
            ```
            {
              "id": 
              "consignation":
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: 成功删除委托
          schema:
            $ref: '#/definitions/Response'
        '405':
          description: Invalid input
  '/services/consign/{id}':
    get:
      tags:
        - consign
      summary: 根据id查询委托
      description: 根据请求中的id查询委托
      operationId: queryConsignByID
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: id
          in: path
          description: 委托id
          type: string
          required: true
      responses:
        '200':
          description: |
            成功查询委托. data内包含JsonArray格式的委托内容
          schema:
            $ref: '#/definitions/Response'
        '405':
          description: Invalid input
  '/services/processInstance/{processInstanceID}':
    get:
      summary: 获取流程实例状态
      tags:
        - processInstance
      description: 根据processInstanceID获取该流程实例状态
      operationId: queryConsignState
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: processInstanceID
          in: path
          type: string
          description: 流程实例在Activiti中的进程ID
          required: true
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
      responses:
        '200':
          description: |
            成功获取委托状态. 
            data含两个属性：
            processInstanceID->委托进程ID
            state->委托状态. 格式为
            ```
            {
              "processInstanceID": "xxx"
              "state": "xxx"
            }
            ```
          schema:
            $ref: '#/definitions/Response'
    put:
      summary: 修改流程实例状态
      description: 根据processInstanceID修改该流程实例状态
      operationId: updateConsignState
      tags:
        - processInstance
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: processInstanceID
          in: path
          type: string
          description: 流程实例在Activiti中的进程ID
          required: true
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - name: params
          in: formData
          description: >
            修改的操作内容。JSON格式。对象名为'object',属性名为'operation', object为consign时，operation有submit/pass/reject
              object为contract时，operation有submit/reviewpass/reviewreject/confirmpass/confirmreject
            eg.

            ```

            {
              "object": "consign"
              "operation": "submit"
            }
          type: string
          required: true
      responses:
        '200':
          description: |
            成功修改流程实例状态，并在data中返回修改后的进程状态。 
            data含两个属性 ：
            processInstanceID->流程实例进程ID .
            state->流程实例状态
            ```
            {
              "processInstanceID": "xxx"
              "state": "xxx"
            }
          schema:
            $ref: '#/definitions/Response'
  /services/contract:
    get:
      tags:
        - contract
      summary: 查询合同
      description: 用户为普通客户时，返回当前该客户的所有合同，如果是工作人员返回所有合同
      operationId: queryContracts
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
      responses:
        '200':
          description: |
            成功查询合同时返回合同. data内包含JsonArray格式的内容内容
            目前没有返回合同的contractBody？
            查询失败时，返回一个失败的status
            ```
            {
              "data": [
                {
                  "processInstanceID": "5001",
                  "createdUserId": "2",
                  "createdTime": "2018-05-28 18:47:22",
                  "id": "1399d1ac-9aad-4ca3-9f44-e49972d147cf"
                },
                {
                  "processInstanceID": "5011",
                  "createdUserId": "2",
                  "createdTime": "2018-05-28 19:00:56",
                  "id": "7356e68f-c01f-4a32-8c5e-4fce3f5508d7"
                },
                {
                  "processInstanceID": "5021",
                  "createdUserId": "2",
                  "createdTime": "2018-05-28 19:02:09",
                  "id": "f0c26114-403c-484b-982b-2aea3c58d1a9"
                }
              ],
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    post:
      tags:
        - contract
      summary: 添加合同
      description: 向数据库中添加合同，成功时返回合同的具体信息以及一个success状态
      operationId: addContract
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            合同的具体内容. JSON格式
            ```
            {
              "contractBody": "content"
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            成功添加合同时的样例response body
            ```
            {
              "data": {
                "processInstanceID": "5001",
                "createdUserId": "2",
                "contractBody": "I Love TaylorSwift",
                "createdTime": "2018-05-28 18:47:22",
                "id": "1399d1ac-9aad-4ca3-9f44-e49972d147cf",
                "state": "TobeSubmit"
              },
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    put:
      tags:
        - contract
      summary: 修改合同
      description: 修改已有的合同，参数中需要包含合同的id
      operationId: editContract
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            合同具体内容. JSON格式. 需要指明合同的ID
            ```
            {
              "id": 
              "contractBody":
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            修改成功时的样例response body
            ```
            {
              "data": {
              "processInstanceID": "5001",
                "createdUserId": "2",
                "contractBody": "I Love TaylorSwift So Much",
                "alteredTime": "2018-05-28 19:16:02",
                "createdTime": "2018-05-28 18:47:22",
                "id": "1399d1ac-9aad-4ca3-9f44-e49972d147cf",
                "state": "TobeSubmit"
              },
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    delete:
      tags:
        - contract
      summary: 删除合同
      description: 删除一个合同，需要提供委托的具体id
      operationId: deleteContract
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            合同具体内容. JSON格式. 需要指明ID,contractBody为非必要
            ```
            {
              "id": 
              "contractBody":
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            成功删除合同
            ```
            {
              "status":"SUCCESS"
            }
            ```
        '405':
          description: Invalid input
  '/services/contract/{id}':
    get:
      tags:
        - contract
      summary: 根据id查询合同
      description: 根据请求中的id查询对应合同
      operationId: queryContractByID
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: id
          in: path
          description: 合同的id
          type: string
          required: true
      responses:
        '200':
          description: |
            成功查询合同. data内包含JsonArray格式的合同内容
            ```
            {
              "data": {
              "processInstanceID": "5011",
              "createdUserId": "2",
              "contractBody": "I Love TaylorSwift So Much",
              "alteredTime": "2018-05-28 19:26:22",
              "createdTime": "2018-05-28 19:00:56",
              "alteredUserId": "2",
              "id": "7356e68f-c01f-4a32-8c5e-4fce3f5508d7"
            },
            "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
  /services/project:
    get:
      tags:
        - project
      summary: 查询工程
      description: 用户为普通客户时，返回当前该客户的所有合同，如果是工作人员返回所有工程
      operationId: queryProjects
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
      responses:
        '200':
          description: |
            成功查询合同时返回工程.返回内容还没有确定
            查询失败时，返回一个失败的status
            ```
            {
              
              "data": [
                {
                  "createdUserId": "2",
                  "createdTime": "2018-06-02 20:16:29",
                  "id": "cdd340fa-501c-42ab-9596-6c55b1a694c2"
                }
              ],
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    post:
      tags:
        - project
      summary: 添加工程
      description: 向数据库中添加工程，但是添加的内容还没有确定，成功时返回合同的具体信息以及一个success状态
      operationId: addProject
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            合同的具体内容. JSON格式
            ```
            {
              "xxx": "xxx"
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            成功添加合同时的样例response body
            ```
            {
              "data": {
                "createdUserId": "2",
                "createdTime": "2018-06-02 20:16:29",
                "id": "cdd340fa-501c-42ab-9596-6c55b1a694c2"
              },
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    put:
      tags:
        - project
      summary: 修改工程
      description: 修改已有的工程，参数中需要包含工程的id，但是还未商定具体内容所以不知道可以对哪些参数进行改动
      operationId: editProject
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            合同具体内容. JSON格式. 需要指明合同的ID
            ```
            {
              "id": 
              "xxx":
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            修改成功时的样例response body
            ```
            {
              "data": {
                "createdUserId": "2",
                "alteredTime": "2018-06-02 20:25:16",
                "createdTime": "2018-06-02 20:24:49",
                "alteredUserId": "2",
                "id": "028c9856-6d00-48ab-8b24-9328c29ef3a8"
              },
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
    delete:
      tags:
        - project
      summary: 删除工程
      description: 删除一个工程，需要提工程的具体id
      operationId: deleteProject
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: username
          in: query
          description: 用户名
          type: string
          required: true
        - name: clientDigest
          in: query
          description: 摘要。登录时由后台传入，用以身份验证
          type: string
          required: true
        - in: formData
          name: params
          description: |
            合同具体内容. JSON格式. 需要指明ID,其他内容为非必要
            ```
            {
              "id": 
              "xxx":
            }
            ```
          type: string
          required: true
      responses:
        '200':
          description: |
            成功删除工程
            ```
            {
              "status":"SUCCESS"
            }
            ```
        '405':
          description: Invalid input
  '/services/project/{id}':
    get:
      tags:
        - project
      summary: 根据id查询工程
      description: 根据请求中的id查询对应工程
      operationId: queryProjectById
      consumes:
        - application/x-www-form-urlencoded
      produces:
        - application/json
      parameters:
        - name: id
          in: path
          description: 工程的id
          type: string
          required: true
      responses:
        '200':
          description: |
            成功查询工程. data内包含JsonArray格式的合同内容
            ```
            {
              "data": {
                "createdUserId": "2",
                "createdTime": "2018-06-02 20:27:01",
                "id": "0aee06e8-f44b-4594-8919-bd93e8f3a49f"
              },
              "status": "SUCCESS"
            }
            ```
        '405':
          description: Invalid input
securityDefinitions:
  petstore_auth:
    type: oauth2
    authorizationUrl: 'http://petstore.swagger.io/oauth/dialog'
    flow: implicit
    scopes:
      'write:pets': modify pets in your account
      'read:pets': read your pets
  api_key:
    type: apiKey
    name: api_key
    in: header
definitions:
  Response:
    type: object
    properties:
      status:
        type: string
        description: 用来表示状态。SUCCESS/FAILURE
        enum:
          - SUCCESS
          - FAILURE
      data:
        type: string
        format: json
        example: json
        description: 用来传送数据，json格式
      message:
        type: string
        description: 用于传输错误信息
